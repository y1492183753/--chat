{"remainingRequest":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\im-ui\\src\\view\\Group.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\im-ui\\src\\view\\Group.vue","mtime":1703809564000},{"path":"D:\\im-ui\\babel.config.js","mtime":1703809560000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1710142166000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1710142168000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBHcm91cEl0ZW0gZnJvbSAnLi4vY29tcG9uZW50cy9ncm91cC9Hcm91cEl0ZW0nOwppbXBvcnQgRmlsZVVwbG9hZCBmcm9tICcuLi9jb21wb25lbnRzL2NvbW1vbi9GaWxlVXBsb2FkJzsKaW1wb3J0IEdyb3VwTWVtYmVyIGZyb20gJy4uL2NvbXBvbmVudHMvZ3JvdXAvR3JvdXBNZW1iZXIudnVlJzsKaW1wb3J0IEFkZEdyb3VwTWVtYmVyIGZyb20gJy4uL2NvbXBvbmVudHMvZ3JvdXAvQWRkR3JvdXBNZW1iZXIudnVlJzsKaW1wb3J0IEhlYWRJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL2NvbW1vbi9IZWFkSW1hZ2UudnVlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJncm91cCIsCiAgY29tcG9uZW50czogewogICAgR3JvdXBJdGVtLAogICAgR3JvdXBNZW1iZXIsCiAgICBGaWxlVXBsb2FkLAogICAgQWRkR3JvdXBNZW1iZXIsCiAgICBIZWFkSW1hZ2UKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWFyY2hUZXh0OiAiIiwKICAgICAgbWF4U2l6ZTogNSAqIDEwMjQgKiAxMDI0LAogICAgICBhY3RpdmVHcm91cDoge30sCiAgICAgIGdyb3VwTWVtYmVyczogW10sCiAgICAgIHNob3dBZGRHcm91cE1lbWJlcjogZmFsc2UsCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgbmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpee+pOiBiuWQjeensCcsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgb25DcmVhdGVHcm91cCgpIHsKICAgICAgdGhpcy4kcHJvbXB0KCfor7fovpPlhaXnvqTogYrlkI3np7AnLCAn5Yib5bu6576k6IGKJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICBpbnB1dFBhdHRlcm46IC9cUy8sCiAgICAgICAgaW5wdXRFcnJvck1lc3NhZ2U6ICfor7fovpPlhaXnvqTogYrlkI3np7AnCiAgICAgIH0pLnRoZW4obyA9PiB7CiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlclN0b3JlLnVzZXJJbmZvOwogICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgbmFtZTogby52YWx1ZSwKICAgICAgICAgIHJlbWFyazogby52YWx1ZSwKICAgICAgICAgIGFsaWFzTmFtZTogdXNlckluZm8ubmFtZSwKICAgICAgICAgIG93bmVySWQ6IHVzZXJJbmZvLmlkCiAgICAgICAgfTsKICAgICAgICB0aGlzLiRodHRwKHsKICAgICAgICAgIHVybDogYC9ncm91cC9jcmVhdGU/Z3JvdXBOYW1lPSR7by52YWx1ZX1gLAogICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfSkudGhlbihncm91cCA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImFkZEdyb3VwIiwgZ3JvdXApOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBvbkFjdGl2ZUl0ZW0oZ3JvdXAsIGluZGV4KSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiYWN0aXZlR3JvdXAiLCBpbmRleCk7CiAgICAgIC8vIHN0b3Jl5pWw5o2u5LiN6IO955u05o6l5L+u5pS577yM5omA5Lul5rex5ou36LSd5LiA5Lu95YaF5a2YCiAgICAgIHRoaXMuYWN0aXZlR3JvdXAgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGdyb3VwKSk7CiAgICAgIC8vIOmHjeaWsOWKoOi9vee+pOaIkOWRmAogICAgICB0aGlzLmxvYWRHcm91cE1lbWJlcnMoKTsKICAgIH0sCiAgICBvbkludml0ZU1lbWJlcigpIHsKICAgICAgdGhpcy5zaG93QWRkR3JvdXBNZW1iZXIgPSB0cnVlOwogICAgfSwKICAgIG9uQ2xvc2VBZGRHcm91cE1lbWJlcigpIHsKICAgICAgdGhpcy5zaG93QWRkR3JvdXBNZW1iZXIgPSBmYWxzZTsKICAgIH0sCiAgICBvblVwbG9hZFN1Y2Nlc3MoZGF0YSkgewogICAgICB0aGlzLmFjdGl2ZUdyb3VwLmhlYWRJbWFnZSA9IGRhdGEub3JpZ2luVXJsOwogICAgICB0aGlzLmFjdGl2ZUdyb3VwLmhlYWRJbWFnZVRodW1iID0gZGF0YS50aHVtYlVybDsKICAgIH0sCiAgICBvblNhdmVHcm91cCgpIHsKICAgICAgdGhpcy4kcmVmc1snZ3JvdXBGb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgbGV0IHZvID0gdGhpcy5hY3RpdmVHcm91cDsKICAgICAgICAgIHRoaXMuJGh0dHAoewogICAgICAgICAgICB1cmw6ICIvZ3JvdXAvbW9kaWZ5IiwKICAgICAgICAgICAgbWV0aG9kOiAicHV0IiwKICAgICAgICAgICAgZGF0YTogdm8KICAgICAgICAgIH0pLnRoZW4oZ3JvdXAgPT4gewogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInVwZGF0ZUdyb3VwIiwgZ3JvdXApOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuS/ruaUueaIkOWKnyIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBvbkRpc3NvbHZlKCkgewogICAgICB0aGlzLiRjb25maXJtKCfnoa7orqTopoHop6PmlaPnvqTogYrlkJc/JywgJ+ehruiupOino+aVoz8nLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRodHRwKHsKICAgICAgICAgIHVybDogYC9ncm91cC9kZWxldGUvJHt0aGlzLmFjdGl2ZUdyb3VwLmlkfWAsCiAgICAgICAgICBtZXRob2Q6ICdkZWxldGUnCiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoYOe+pOiBiicke3RoaXMuYWN0aXZlR3JvdXAubmFtZX0n5bey6Kej5pWjYCk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInJlbW92ZUdyb3VwIiwgdGhpcy5hY3RpdmVHcm91cC5pZCk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInJlbW92ZUdyb3VwQ2hhdCIsIHRoaXMuYWN0aXZlR3JvdXAuaWQpOwogICAgICAgICAgdGhpcy5yZXNldCgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBvbktpY2sobWVtYmVyKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oYOehruWumuWwhuaIkOWRmCcke21lbWJlci5hbGlhc05hbWV9J+enu+WHuue+pOiBiuWQl++8n2AsICfnoa7orqTnp7vlh7o/JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgICB1cmw6IGAvZ3JvdXAva2ljay8ke3RoaXMuYWN0aXZlR3JvdXAuaWR9YCwKICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsCiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgdXNlcklkOiBtZW1iZXIudXNlcklkCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoYOW3suWwhiR7bWVtYmVyLmFsaWFzTmFtZX3np7vlh7rnvqTogYpgKTsKICAgICAgICAgIG1lbWJlci5xdWl0ID0gdHJ1ZTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgb25RdWl0KCkgewogICAgICB0aGlzLiRjb25maXJtKCfpgIDlh7rnvqTogYrlkI7lsIbkuI3lho3mjqXlj5fnvqTph4znmoTmtojmga/vvIznoa7orqTpgIDlh7rlkJfvvJ8nLCAn56Gu6K6k6YCA5Ye6PycsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuJGh0dHAoewogICAgICAgICAgdXJsOiBgL2dyb3VwL3F1aXQvJHt0aGlzLmFjdGl2ZUdyb3VwLmlkfWAsCiAgICAgICAgICBtZXRob2Q6ICdkZWxldGUnCiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInJlbW92ZUdyb3VwIiwgdGhpcy5hY3RpdmVHcm91cC5pZCk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInJlbW92ZUdyb3VwQ2hhdCIsIHRoaXMuYWN0aXZlR3JvdXAuaWQpOwogICAgICAgICAgdGhpcy5yZXNldCgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBvblNlbmRNZXNzYWdlKCkgewogICAgICBsZXQgY2hhdCA9IHsKICAgICAgICB0eXBlOiAnR1JPVVAnLAogICAgICAgIHRhcmdldElkOiB0aGlzLmFjdGl2ZUdyb3VwLmlkLAogICAgICAgIHNob3dOYW1lOiB0aGlzLmFjdGl2ZUdyb3VwLnJlbWFyaywKICAgICAgICBoZWFkSW1hZ2U6IHRoaXMuYWN0aXZlR3JvdXAuaGVhZEltYWdlCiAgICAgIH07CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgib3BlbkNoYXQiLCBjaGF0KTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJhY3RpdmVDaGF0IiwgMCk7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvaG9tZS9jaGF0Iik7CiAgICB9LAogICAgbG9hZEdyb3VwTWVtYmVycygpIHsKICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgdXJsOiBgL2dyb3VwL21lbWJlcnMvJHt0aGlzLmFjdGl2ZUdyb3VwLmlkfWAsCiAgICAgICAgbWV0aG9kOiAiZ2V0IgogICAgICB9KS50aGVuKG1lbWJlcnMgPT4gewogICAgICAgIHRoaXMuZ3JvdXBNZW1iZXJzID0gbWVtYmVyczsKICAgICAgfSk7CiAgICB9LAogICAgcmVzZXQoKSB7CiAgICAgIHRoaXMuYWN0aXZlR3JvdXAgPSB7fTsKICAgICAgdGhpcy5ncm91cE1lbWJlcnMgPSBbXTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBncm91cFN0b3JlKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZ3JvdXBTdG9yZTsKICAgIH0sCiAgICBvd25lck5hbWUoKSB7CiAgICAgIGxldCBtZW1iZXIgPSB0aGlzLmdyb3VwTWVtYmVycy5maW5kKG0gPT4gbS51c2VySWQgPT0gdGhpcy5hY3RpdmVHcm91cC5vd25lcklkKTsKICAgICAgcmV0dXJuIG1lbWJlciAmJiBtZW1iZXIuYWxpYXNOYW1lOwogICAgfSwKICAgIGlzT3duZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZUdyb3VwLm93bmVySWQgPT0gdGhpcy4kc3RvcmUuc3RhdGUudXNlclN0b3JlLnVzZXJJbmZvLmlkOwogICAgfSwKICAgIGltYWdlQWN0aW9uKCkgewogICAgICByZXR1cm4gYC9pbWFnZS91cGxvYWRgOwogICAgfQogIH0KfTs="},{"version":3,"names":["GroupItem","FileUpload","GroupMember","AddGroupMember","HeadImage","name","components","data","searchText","maxSize","activeGroup","groupMembers","showAddGroupMember","rules","required","message","trigger","methods","onCreateGroup","$prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage","then","o","userInfo","$store","state","userStore","value","remark","aliasName","ownerId","id","$http","url","method","group","commit","onActiveItem","index","JSON","parse","stringify","loadGroupMembers","onInviteMember","onCloseAddGroupMember","onUploadSuccess","headImage","originUrl","headImageThumb","thumbUrl","onSaveGroup","$refs","validate","valid","vo","$message","success","onDissolve","$confirm","type","reset","onKick","member","params","userId","quit","onQuit","onSendMessage","chat","targetId","showName","$router","push","members","computed","groupStore","ownerName","find","m","isOwner","imageAction"],"sources":["src/view/Group.vue"],"sourcesContent":["<template>\n\t<el-container class=\"group-page\">\n\t\t<el-aside width=\"260px\" class=\"group-list-box\">\n\t\t\t<div class=\"group-list-header\">\n\t\t\t\t<div class=\"group-list-search\">\n\t\t\t\t\t<el-input width=\"200px\" placeholder=\"搜索群聊\" v-model=\"searchText\">\n\t\t\t\t\t\t<el-button slot=\"append\" icon=\"el-icon-search\"></el-button>\n\t\t\t\t\t</el-input>\n\t\t\t\t</div>\n\t\t\t\t<el-button plain icon=\"el-icon-plus\" style=\"border: none; padding: 12px; font-size: 20px;color: black;\"\n\t\t\t\t\ttitle=\"创建群聊\" @click=\"onCreateGroup()\"></el-button>\n\t\t\t</div>\n\t\t\t<el-scrollbar class=\"group-list-items\">\n\t\t\t\t<div v-for=\"(group,index) in groupStore.groups\" :key=\"index\">\n\t\t\t\t\t<group-item v-show=\"group.remark.startsWith(searchText)\" :group=\"group\"\n\t\t\t\t\t\t:active=\"group === groupStore.activeGroup\" @click.native=\"onActiveItem(group,index)\">\n\t\t\t\t\t</group-item>\n\t\t\t\t</div>\n\t\t\t</el-scrollbar>\n\t\t</el-aside>\n\t\t<el-container class=\"group-box\">\n\t\t\t<div class=\"group-header\" v-show=\"activeGroup.id\">\n\t\t\t\t{{activeGroup.remark}}({{groupMembers.length}})\n\t\t\t</div>\n\t\t\t<el-scrollbar class=\"group-container\">\n\t\t\t\t<div v-show=\"activeGroup.id\">\n\t\t\t\t\t<div class=\"group-info\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<file-upload  v-show=\"isOwner\" class=\"avatar-uploader\" :action=\"imageAction\"\n\t\t\t\t\t\t\t\t:showLoading=\"true\" :maxSize=\"maxSize\" @success=\"onUploadSuccess\"\n\t\t\t\t\t\t\t\t:fileTypes=\"['image/jpeg', 'image/png', 'image/jpg','image/webp']\">\n\t\t\t\t\t\t\t\t<img v-if=\"activeGroup.headImage\" :src=\"activeGroup.headImage\" class=\"avatar\">\n\t\t\t\t\t\t\t\t<i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n\t\t\t\t\t\t\t</file-upload>\n\t\t\t\t\t\t\t<head-image  v-show=\"!isOwner\" class=\"avatar\" :size=\"200\" \n\t\t\t\t\t\t\t\t:url=\"activeGroup.headImage\"\n\t\t\t\t\t\t\t\t:name=\"activeGroup.remark\">\n\t\t\t\t\t\t\t</head-image>\n\t\t\t\t\t\t\t<el-button class=\"send-btn\" icon=\"el-icon-chat-dot-round\" type=\"primary\" @click=\"onSendMessage()\">发送消息</el-button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<el-form class=\"group-form\" label-width=\"130px\" :model=\"activeGroup\" :rules=\"rules\"\n\t\t\t\t\t\t\tref=\"groupForm\">\n\t\t\t\t\t\t\t<el-form-item label=\"群聊名称\" prop=\"name\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"activeGroup.name\" :disabled=\"!isOwner\" maxlength=\"20\"></el-input>\n\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t<el-form-item label=\"群主\">\n\t\t\t\t\t\t\t\t<el-input :value=\"ownerName\" disabled></el-input>\n\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t<el-form-item label=\"备注\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"activeGroup.remark\" placeholder=\"群聊的备注仅自己可见\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"20\"></el-input>\n\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t<el-form-item label=\"我在本群的昵称\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"activeGroup.aliasName\" placeholder=\"\" maxlength=\"20\"></el-input>\n\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t<el-form-item label=\"群公告\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"activeGroup.notice\" :disabled=\"!isOwner\" type=\"textarea\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"1024\" placeholder=\"群主未设置\"></el-input>\n\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<el-button type=\"success\" @click=\"onSaveGroup()\">提交</el-button>\n\t\t\t\t\t\t\t\t<el-button type=\"danger\" v-show=\"!isOwner\" @click=\"onQuit()\">退出群聊</el-button>\n\t\t\t\t\t\t\t\t<el-button type=\"danger\" v-show=\"isOwner\" @click=\"onDissolve()\">解散群聊</el-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</el-form>\n\t\t\t\t\t</div>\n\t\t\t\t\t<el-divider content-position=\"center\"></el-divider>\n\t\t\t\t\t<el-scrollbar style=\"height:200px;\">\n\t\t\t\t\t\t<div class=\"group-member-list\">\n\t\t\t\t\t\t\t<div v-for=\"(member) in groupMembers\" :key=\"member.id\">\n\t\t\t\t\t\t\t\t<group-member v-show=\"!member.quit\" class=\"group-member\" :member=\"member\"\n\t\t\t\t\t\t\t\t\t:showDel=\"isOwner&&member.userId!=activeGroup.ownerId\"\n\t\t\t\t\t\t\t\t\t@del=\"onKick\"></group-member>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"group-invite\">\n\t\t\t\t\t\t\t\t<div class=\"invite-member-btn\" title=\"邀请好友进群聊\" @click=\"onInviteMember()\">\n\t\t\t\t\t\t\t\t\t<i class=\"el-icon-plus\"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"invite-member-text\">邀请</div>\n\t\t\t\t\t\t\t\t<add-group-member :visible=\"showAddGroupMember\" :groupId=\"activeGroup.id\"\n\t\t\t\t\t\t\t\t\t:members=\"groupMembers\" @reload=\"loadGroupMembers\"\n\t\t\t\t\t\t\t\t\t@close=\"onCloseAddGroupMember\"></add-group-member>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</el-scrollbar>\n\t\t\t\t</div>\n\t\t\t</el-scrollbar>\n\t\t</el-container>\n\t</el-container>\n</template>\n\n\n<script>\n\timport GroupItem from '../components/group/GroupItem';\n\timport FileUpload from '../components/common/FileUpload';\n\timport GroupMember from '../components/group/GroupMember.vue';\n\timport AddGroupMember from '../components/group/AddGroupMember.vue';\n\timport HeadImage from '../components/common/HeadImage.vue';\n\texport default {\n\t\tname: \"group\",\n\t\tcomponents: {\n\t\t\tGroupItem,\n\t\t\tGroupMember,\n\t\t\tFileUpload,\n\t\t\tAddGroupMember,\n\t\t\tHeadImage\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tsearchText: \"\",\n\t\t\t\tmaxSize: 5 * 1024 * 1024,\n\t\t\t\tactiveGroup: {},\n\t\t\t\tgroupMembers: [],\n\t\t\t\tshowAddGroupMember: false,\n\t\t\t\trules: {\n\t\t\t\t\tname: [{\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tmessage: '请输入群聊名称',\n\t\t\t\t\t\ttrigger: 'blur'\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tmethods: {\n\t\t\tonCreateGroup() {\n\t\t\t\tthis.$prompt('请输入群聊名称', '创建群聊', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\tinputPattern: /\\S/,\n\t\t\t\t\tinputErrorMessage: '请输入群聊名称'\n\t\t\t\t}).then((o) => {\n\t\t\t\t\tlet userInfo = this.$store.state.userStore.userInfo;\n\t\t\t\t\tlet data = {\n\t\t\t\t\t\tname: o.value,\n\t\t\t\t\t\tremark: o.value,\n\t\t\t\t\t\taliasName: userInfo.name,\n\t\t\t\t\t\townerId: userInfo.id\n\t\t\t\t\t}\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: `/group/create?groupName=${o.value}`,\n\t\t\t\t\t\tmethod: 'post',\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}).then((group) => {\n\t\t\t\t\t\tthis.$store.commit(\"addGroup\", group);\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\tonActiveItem(group, index) {\n\t\t\t\tthis.$store.commit(\"activeGroup\", index);\n\t\t\t\t// store数据不能直接修改，所以深拷贝一份内存\n\t\t\t\tthis.activeGroup = JSON.parse(JSON.stringify(group));\n\t\t\t\t// 重新加载群成员\n\t\t\t\tthis.loadGroupMembers();\n\t\t\t},\n\t\t\tonInviteMember() {\n\t\t\t\tthis.showAddGroupMember = true;\n\t\t\t},\n\t\t\tonCloseAddGroupMember() {\n\t\t\t\tthis.showAddGroupMember = false;\n\t\t\t},\n\t\t\tonUploadSuccess(data) {\n\t\t\t\tthis.activeGroup.headImage =data.originUrl;\n\t\t\t\tthis.activeGroup.headImageThumb = data.thumbUrl;\n\t\t\t},\n\t\t\tonSaveGroup() {\n\t\t\t\tthis.$refs['groupForm'].validate((valid) => {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tlet vo = this.activeGroup;\n\t\t\t\t\t\tthis.$http({\n\t\t\t\t\t\t\turl: \"/group/modify\",\n\t\t\t\t\t\t\tmethod: \"put\",\n\t\t\t\t\t\t\tdata: vo\n\t\t\t\t\t\t}).then((group) => {\n\t\t\t\t\t\t\tthis.$store.commit(\"updateGroup\", group);\n\t\t\t\t\t\t\tthis.$message.success(\"修改成功\");\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tonDissolve() {\n\t\t\t\tthis.$confirm('确认要解散群聊吗?', '确认解散?', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\ttype: 'warning'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: `/group/delete/${this.activeGroup.id}`,\n\t\t\t\t\t\tmethod: 'delete'\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.$message.success(`群聊'${this.activeGroup.name}'已解散`);\n\t\t\t\t\t\tthis.$store.commit(\"removeGroup\", this.activeGroup.id);\n\t\t\t\t\t\tthis.$store.commit(\"removeGroupChat\", this.activeGroup.id);\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t});\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tonKick(member) {\n\t\t\t\tthis.$confirm(`确定将成员'${member.aliasName}'移出群聊吗？`, '确认移出?', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\ttype: 'warning'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: `/group/kick/${this.activeGroup.id}`,\n\t\t\t\t\t\tmethod: 'delete',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tuserId: member.userId\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.$message.success(`已将${member.aliasName}移出群聊`);\n\t\t\t\t\t\tmember.quit = true;\n\t\t\t\t\t});\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tonQuit() {\n\t\t\t\tthis.$confirm('退出群聊后将不再接受群里的消息，确认退出吗？', '确认退出?', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\ttype: 'warning'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: `/group/quit/${this.activeGroup.id}`,\n\t\t\t\t\t\tmethod: 'delete'\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.$store.commit(\"removeGroup\", this.activeGroup.id);\n\t\t\t\t\t\tthis.$store.commit(\"removeGroupChat\", this.activeGroup.id);\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t});\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tonSendMessage() {\n\t\t\t\tlet chat = {\n\t\t\t\t\ttype: 'GROUP',\n\t\t\t\t\ttargetId: this.activeGroup.id,\n\t\t\t\t\tshowName: this.activeGroup.remark,\n\t\t\t\t\theadImage: this.activeGroup.headImage,\n\t\t\t\t};\n\t\t\t\tthis.$store.commit(\"openChat\", chat);\n\t\t\t\tthis.$store.commit(\"activeChat\", 0);\n\t\t\t\tthis.$router.push(\"/home/chat\");\n\t\t\t},\n\t\t\tloadGroupMembers() {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/group/members/${this.activeGroup.id}`,\n\t\t\t\t\tmethod: \"get\"\n\t\t\t\t}).then((members) => {\n\t\t\t\t\tthis.groupMembers = members;\n\t\t\t\t})\n\t\t\t},\n\t\t\treset(){\n\t\t\t\tthis.activeGroup={};\n\t\t\t\tthis.groupMembers=[];\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tgroupStore() {\n\t\t\t\treturn this.$store.state.groupStore;\n\t\t\t},\n\t\t\townerName() {\n\t\t\t\tlet member = this.groupMembers.find((m) => m.userId == this.activeGroup.ownerId);\n\t\t\t\treturn member && member.aliasName;\n\t\t\t},\n\t\t\tisOwner() {\n\t\t\t\treturn this.activeGroup.ownerId == this.$store.state.userStore.userInfo.id;\n\t\t\t},\n\t\t\timageAction() {\n\t\t\t\treturn `/image/upload`;\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.group-page {\n\t\t.group-list-box {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tborder: #dddddd solid 1px;\n\t\t\tbackground: white;\n\n\t\t\t.group-list-header {\n\t\t\t\theight: 50px;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tpadding: 5px;\n\t\t\t\tbackground-color: white;\n\n\t\t\t\t.group-list-search {\n\t\t\t\t\tflex: 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.group-list-items {\n\t\t\t\tflex: 1;\n\t\t\t}\n\t\t}\n\n\t\t.group-box {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tborder: #dddddd solid 1px;\n\n\t\t\t.group-header {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 50px;\n\t\t\t\tpadding: 5px;\n\t\t\t\tline-height: 50px;\n\t\t\t\tfont-size: 20px;\n\t\t\t\tfont-weight: 600;\n\t\t\t\ttext-align: left;\n\t\t\t\ttext-indent: 10px;\n\t\t\t\tbackground-color: white;\n\t\t\t\tborder: #dddddd solid 1px;\n\t\t\t}\n\n\t\t\t.group-container {\n\t\t\t\tpadding: 20px;\n\t\t\t\t.group-info {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tpadding: 5px 20px;\n\n\t\t\t\t\t.group-form {\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\tpadding-left: 40px;\n\t\t\t\t\t\tmax-width: 700px;\n\t\t\t\t\t}\n\n\t\t\t\t\t.avatar-uploader {\n\t\t\t\t\t\ttext-align: left;\n\n\t\t\t\t\t\t.el-upload {\n\t\t\t\t\t\t\tborder: 1px dashed #d9d9d9 !important;\n\t\t\t\t\t\t\tborder-radius: 6px;\n\t\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.el-upload:hover {\n\t\t\t\t\t\t\tborder-color: #409EFF;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.avatar-uploader-icon {\n\t\t\t\t\t\t\tfont-size: 28px;\n\t\t\t\t\t\t\tcolor: #8c939d;\n\t\t\t\t\t\t\twidth: 200px;\n\t\t\t\t\t\t\theight: 200px;\n\t\t\t\t\t\t\tline-height: 200px;\n\t\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.avatar {\n\t\t\t\t\t\t\twidth: 200px;\n\t\t\t\t\t\t\theight: 200px;\n\t\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.send-btn {\n\t\t\t\t\t\tmargin-top: 20px;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.group-member-list {\n\t\t\t\t\tpadding: 5px 20px;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tflex-wrap: wrap;\n\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\ttext-align: center;\n\n\t\t\t\t\t.group-member {\n\t\t\t\t\t\tmargin-right: 15px;\n\t\t\t\t\t}\n\n\t\t\t\t\t.group-invite {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\twidth: 60px;\n\n\t\t\t\t\t\t.invite-member-btn {\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\theight: 60px;\n\t\t\t\t\t\t\tline-height: 60px;\n\t\t\t\t\t\t\tborder: #cccccc solid 1px;\n\t\t\t\t\t\t\tfont-size: 25px;\n\t\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t\tbox-sizing: border-box;\n\n\t\t\t\t\t\t\t&:hover {\n\t\t\t\t\t\t\t\tborder: #aaaaaa solid 1px;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.invite-member-text {\n\t\t\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\theight: 30px;\n\t\t\t\t\t\t\tline-height: 30px;\n\t\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\t\t\t\toverflow: hidden\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>"],"mappings":"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","ignoreList":[]}]}