{"remainingRequest":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\im-ui\\src\\components\\chat\\ChatVideoAcceptor.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\im-ui\\src\\components\\chat\\ChatVideoAcceptor.vue","mtime":1703809564000},{"path":"D:\\im-ui\\babel.config.js","mtime":1703809560000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1710142166000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1710142168000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IEhlYWRJbWFnZSBmcm9tICcuLi9jb21tb24vSGVhZEltYWdlLnZ1ZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAidmlkZW9BY2NlcHRvciIsCiAgY29tcG9uZW50czogewogICAgSGVhZEltYWdlCiAgfSwKICBwcm9wczogewogICAgZnJpZW5kOiB7CiAgICAgIHR5cGU6IE9iamVjdAogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9mZmVyOiB7fSwKICAgICAgYXVkaW86IG5ldyBBdWRpbygpCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYWNjcGV0KCkgewogICAgICBsZXQgaW5mbyA9IHsKICAgICAgICBmcmllbmQ6IHRoaXMuZnJpZW5kLAogICAgICAgIG1hc3RlcjogZmFsc2UsCiAgICAgICAgb2ZmZXI6IHRoaXMub2ZmZXIKICAgICAgfTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzaG93Q2hhdFByaXZhdGVWaWRlb0JveCIsIGluZm8pOwogICAgICB0aGlzLmNsb3NlKCk7CiAgICB9LAogICAgcmVqZWN0KCkgewogICAgICB0aGlzLiRodHRwKHsKICAgICAgICB1cmw6IGAvd2VicnRjL3ByaXZhdGUvcmVqZWN0P3VpZD0ke3RoaXMuZnJpZW5kLmlkfWAsCiAgICAgICAgbWV0aG9kOiAncG9zdCcKICAgICAgfSk7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0sCiAgICBmYWlsZWQocmVhc29uKSB7CiAgICAgIHRoaXMuJGh0dHAoewogICAgICAgIHVybDogYC93ZWJydGMvcHJpdmF0ZS9mYWlsZWQ/dWlkPSR7dGhpcy5mcmllbmQuaWR9JnJlYXNvbj0ke3JlYXNvbn1gLAogICAgICAgIG1ldGhvZDogJ3Bvc3QnCiAgICAgIH0pOwogICAgICB0aGlzLmNsb3NlKCk7CiAgICB9LAogICAgb25DYWxsKG1zZ0luZm8pIHsKICAgICAgdGhpcy5vZmZlciA9IEpTT04ucGFyc2UobXNnSW5mby5jb250ZW50KTsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJTdG9yZS5zdGF0ZSA9PSB0aGlzLiRlbnVtcy5VU0VSX1NUQVRFLkJVU1kpIHsKICAgICAgICB0aGlzLmZhaWxlZCgi5a+55pa55q2j5b+ZLOaaguaXtuaXoOazleaOpeWQrCIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAvLyDotoXml7bmnKrmjqXlkKwKICAgICAgdGhpcy50aW1lciAmJiBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7CiAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLmZhaWxlZCgi5a+55pa55pyq5o6l5ZCsIik7CiAgICAgIH0sIDMwMDAwKTsKICAgICAgdGhpcy5hdWRpby5wbGF5KCk7CiAgICB9LAogICAgb25DYW5jZWwoKSB7CiAgICAgIC8vIOWPlua2iOinhumikemAmuivneivt+axggogICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWvueaWueWPlua2iOS6huWRvOWPqyIpOwogICAgICB0aGlzLmNsb3NlKCk7CiAgICB9LAogICAgaGFuZGxlTWVzc2FnZShtc2dJbmZvKSB7CiAgICAgIGlmIChtc2dJbmZvLnR5cGUgPT0gdGhpcy4kZW51bXMuTUVTU0FHRV9UWVBFLlJUQ19DQUxMKSB7CiAgICAgICAgdGhpcy5vbkNhbGwobXNnSW5mbyk7CiAgICAgIH0gZWxzZSBpZiAobXNnSW5mby50eXBlID09IHRoaXMuJGVudW1zLk1FU1NBR0VfVFlQRS5SVENfQ0FOQ0VMKSB7CiAgICAgICAgdGhpcy5vbkNhbmNlbCgpOwogICAgICB9CiAgICB9LAogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMudGltZXIgJiYgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwogICAgICB0aGlzLmF1ZGlvLnBhdXNlKCk7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlIik7CiAgICB9LAogICAgaW5pdEF1ZGlvKCkgewogICAgICBsZXQgdXJsID0gcmVxdWlyZShgQC9hc3NldHMvYXVkaW8vY2FsbC53YXZgKTsKICAgICAgdGhpcy5hdWRpby5zcmMgPSB1cmw7CiAgICAgIHRoaXMuYXVkaW8ubG9vcCA9IHRydWU7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgLy8g5Yid5aeL5YyW6K+t6Z+zCiAgICB0aGlzLmluaXRBdWRpbygpOwogIH0KfTs="},{"version":3,"names":["HeadImage","name","components","props","friend","type","Object","data","offer","audio","Audio","methods","accpet","info","master","$store","commit","close","reject","$http","url","id","method","failed","reason","onCall","msgInfo","JSON","parse","content","state","userStore","$enums","USER_STATE","BUSY","timer","clearTimeout","setTimeout","play","onCancel","$message","success","handleMessage","MESSAGE_TYPE","RTC_CALL","RTC_CANCEL","pause","$emit","initAudio","require","src","loop","mounted"],"sources":["src/components/chat/ChatVideoAcceptor.vue"],"sourcesContent":["<template>\n\t<div class=\"chat-video-acceptor\">\n\n\t\t<head-image :id=\"friend.id\" :name=\"friend.nickName\" :url=\"friend.headImage\" :size=\"100\"></head-image>\n\n\t\t<div class=\"acceptor-text\">\n\t\t\t{{friend.nickName}} 请求和您进行视频通话...\n\t\t</div>\n\t\t<div class=\"acceptor-btn-group\">\n\t\t\t<div class=\"icon iconfont icon-phone-accept accept\" @click=\"accpet()\" title=\"接受\"></div>\n\t\t\t<div class=\"icon iconfont icon-phone-reject reject\" @click=\"reject()\" title=\"拒绝\"></div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport HeadImage from '../common/HeadImage.vue';\n\n\texport default {\n\t\tname: \"videoAcceptor\",\n\t\tcomponents: {\n\t\t\tHeadImage\n\t\t},\n\t\tprops: {\n\t\t\tfriend: {\n\t\t\t\ttype: Object\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\toffer: {},\n\t\t\t\taudio: new Audio()\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\taccpet() {\n\t\t\t\tlet info = {\n\t\t\t\t\tfriend: this.friend,\n\t\t\t\t\tmaster: false,\n\t\t\t\t\toffer: this.offer\n\t\t\t\t}\n\t\t\t\tthis.$store.commit(\"showChatPrivateVideoBox\", info);\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\treject() {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/webrtc/private/reject?uid=${this.friend.id}`,\n\t\t\t\t\tmethod: 'post'\n\t\t\t\t})\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\tfailed(reason) {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/webrtc/private/failed?uid=${this.friend.id}&reason=${reason}`,\n\t\t\t\t\tmethod: 'post'\n\t\t\t\t})\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\tonCall(msgInfo) {\n\t\t\t\tthis.offer = JSON.parse(msgInfo.content);\n\t\t\t\tif (this.$store.state.userStore.state == this.$enums.USER_STATE.BUSY) {\n\t\t\t\t\tthis.failed(\"对方正忙,暂时无法接听\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// 超时未接听\n\t\t\t\tthis.timer && clearTimeout(this.timer);\n\t\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\t\tthis.failed(\"对方未接听\");\n\t\t\t\t}, 30000)\n\t\t\t\tthis.audio.play();\n\t\t\t},\n\t\t\tonCancel() {\n\t\t\t\t// 取消视频通话请求\n\t\t\t\tthis.$message.success(\"对方取消了呼叫\");\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\thandleMessage(msgInfo) {\n\t\t\t\tif (msgInfo.type == this.$enums.MESSAGE_TYPE.RTC_CALL) {\n\t\t\t\t\tthis.onCall(msgInfo);\n\t\t\t\t} else if (msgInfo.type == this.$enums.MESSAGE_TYPE.RTC_CANCEL) {\n\t\t\t\t\tthis.onCancel();\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose() {\n\t\t\t\tthis.timer && clearTimeout(this.timer);\n\t\t\t\tthis.audio.pause();\n\t\t\t\tthis.$emit(\"close\");\n\t\t\t},\n\t\t\tinitAudio() {\n\t\t\t\tlet url = require(`@/assets/audio/call.wav`);\n\t\t\t\tthis.audio.src = url;\n\t\t\t\tthis.audio.loop = true;\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\t// 初始化语音\n\t\t\tthis.initAudio();\n\n\t\t}\n\t}\n</script>\n\n<style scoped lang=\"scss\">\n\t.chat-video-acceptor {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tright: 5px;\n\t\tbottom: 5px;\n\t\twidth: 250px;\n\t\theight: 250px;\n\t\tpadding: 20px;\n\t\tbackground-color: #eeeeee;\n\t\tborder: #dddddd solid 5px;\n\t\tborder-radius: 3%;\n\n\t\t.acceptor-text {\n\t\t\tpadding: 10px;\n\t\t\ttext-align: center;\n\t\t\tfont-size: 16px;\n\t\t}\n\n\t\t.acceptor-btn-group {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-around;\n\t\t\tmargin-top: 20px;\n\t\t\twidth: 100%;\n\n\t\t\t.icon {\n\t\t\t\tfont-size: 60px;\n\t\t\t\tcursor: pointer;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\t&.accept {\n\t\t\t\t\tcolor: green;\n\t\t\t\t\tanimation: anim 2s ease-in infinite, vibration 2s ease-in infinite;\n\n\t\t\t\t\t@keyframes anim {\n\t\t\t\t\t\t0% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 4px #ffffff;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t10% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 8px rgba(255, 165, 0, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t25% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 12px rgba(255, 210, 128, 1), 0 1px 0 16px rgba(255, 201, 102, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t50% {\n\t\t\t\t\t\t\tbox-shadow: 0 2px 5px 10px rgba(255, 184, 51, 1), 0 2px 5px 23px rgba(248, 248, 255, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t@keyframes vibration {\n\t\t\t\t\t\t0% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t25% {\n\t\t\t\t\t\t\ttransform: rotate(20deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t50% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t75% {\n\t\t\t\t\t\t\ttransform: rotate(-15deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t&.reject {\n\t\t\t\t\tcolor: red;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>"],"mappings":"AAgBA,OAAAA,SAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IACAF;EACA;EACAG,KAAA;IACAC,MAAA;MACAC,IAAA,EAAAC;IACA;EACA;EACAC,KAAA;IACA;MACAC,KAAA;MACAC,KAAA,MAAAC,KAAA;IACA;EACA;EACAC,OAAA;IACAC,OAAA;MACA,IAAAC,IAAA;QACAT,MAAA,OAAAA,MAAA;QACAU,MAAA;QACAN,KAAA,OAAAA;MACA;MACA,KAAAO,MAAA,CAAAC,MAAA,4BAAAH,IAAA;MACA,KAAAI,KAAA;IACA;IACAC,OAAA;MACA,KAAAC,KAAA;QACAC,GAAA,qCAAAhB,MAAA,CAAAiB,EAAA;QACAC,MAAA;MACA;MACA,KAAAL,KAAA;IACA;IACAM,OAAAC,MAAA;MACA,KAAAL,KAAA;QACAC,GAAA,qCAAAhB,MAAA,CAAAiB,EAAA,WAAAG,MAAA;QACAF,MAAA;MACA;MACA,KAAAL,KAAA;IACA;IACAQ,OAAAC,OAAA;MACA,KAAAlB,KAAA,GAAAmB,IAAA,CAAAC,KAAA,CAAAF,OAAA,CAAAG,OAAA;MACA,SAAAd,MAAA,CAAAe,KAAA,CAAAC,SAAA,CAAAD,KAAA,SAAAE,MAAA,CAAAC,UAAA,CAAAC,IAAA;QACA,KAAAX,MAAA;QACA;MACA;MACA;MACA,KAAAY,KAAA,IAAAC,YAAA,MAAAD,KAAA;MACA,KAAAA,KAAA,GAAAE,UAAA;QACA,KAAAd,MAAA;MACA;MACA,KAAAd,KAAA,CAAA6B,IAAA;IACA;IACAC,SAAA;MACA;MACA,KAAAC,QAAA,CAAAC,OAAA;MACA,KAAAxB,KAAA;IACA;IACAyB,cAAAhB,OAAA;MACA,IAAAA,OAAA,CAAArB,IAAA,SAAA2B,MAAA,CAAAW,YAAA,CAAAC,QAAA;QACA,KAAAnB,MAAA,CAAAC,OAAA;MACA,WAAAA,OAAA,CAAArB,IAAA,SAAA2B,MAAA,CAAAW,YAAA,CAAAE,UAAA;QACA,KAAAN,QAAA;MACA;IACA;IACAtB,MAAA;MACA,KAAAkB,KAAA,IAAAC,YAAA,MAAAD,KAAA;MACA,KAAA1B,KAAA,CAAAqC,KAAA;MACA,KAAAC,KAAA;IACA;IACAC,UAAA;MACA,IAAA5B,GAAA,GAAA6B,OAAA;MACA,KAAAxC,KAAA,CAAAyC,GAAA,GAAA9B,GAAA;MACA,KAAAX,KAAA,CAAA0C,IAAA;IACA;EACA;EACAC,QAAA;IACA;IACA,KAAAJ,SAAA;EAEA;AACA","ignoreList":[]}]}