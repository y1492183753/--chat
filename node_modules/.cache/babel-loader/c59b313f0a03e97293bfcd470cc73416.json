{"remainingRequest":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\im-ui\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\im-ui\\src\\api\\httpRequest.js","dependencies":[{"path":"D:\\im-ui\\src\\api\\httpRequest.js","mtime":1703809560000},{"path":"D:\\im-ui\\babel.config.js","mtime":1703809560000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1710142166000},{"path":"D:\\im-ui\\node_modules\\eslint-loader\\index.js","mtime":1710142168000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJvdXRlciBmcm9tICdAL3JvdXRlcic7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKY29uc3QgaHR0cCA9IGF4aW9zLmNyZWF0ZSh7CiAgYmFzZVVSTDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSSwKICB0aW1lb3V0OiAxMDAwICogMzAsCiAgd2l0aENyZWRlbnRpYWxzOiB0cnVlLAogIGhlYWRlcnM6IHsKICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcKICB9Cn0pOwoKLyoqCiAqIOivt+axguaLpuaIqgogKi8KaHR0cC5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoY29uZmlnID0+IHsKICBsZXQgYWNjZXNzVG9rZW4gPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJhY2Nlc3NUb2tlbiIpOwogIGlmIChhY2Nlc3NUb2tlbikgewogICAgY29uZmlnLmhlYWRlcnMuYWNjZXNzVG9rZW4gPSBlbmNvZGVVUklDb21wb25lbnQoYWNjZXNzVG9rZW4pOwogIH0KICByZXR1cm4gY29uZmlnOwp9LCBlcnJvciA9PiB7CiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7CgovKioKICog5ZON5bqU5oum5oiqCiAqLwpodHRwLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoYXN5bmMgcmVzcG9uc2UgPT4gewogIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhOwogIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDQwMCkgewogICAgcm91dGVyLnJlcGxhY2UoIi9sb2dpbiIpOwogIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDQwMSkgewogICAgY29uc29sZS5sb2coInRva2Vu5aSx5pWI77yM5bCd6K+V6YeN5paw6I635Y+WIik7CiAgICBsZXQgcmVmcmVzaFRva2VuID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgicmVmcmVzaFRva2VuIik7CiAgICBpZiAoIXJlZnJlc2hUb2tlbikgewogICAgICByb3V0ZXIucmVwbGFjZSgiL2xvZ2luIik7CiAgICB9CiAgICAvLyDlj5HpgIHor7fmsYIsIOi/m+ihjOWIt+aWsHRva2Vu5pON5L2cLCDojrflj5bmlrDnmoR0b2tlbgogICAgY29uc3QgZGF0YSA9IGF3YWl0IGh0dHAoewogICAgICBtZXRob2Q6ICdwdXQnLAogICAgICB1cmw6ICcvcmVmcmVzaFRva2VuJywKICAgICAgaGVhZGVyczogewogICAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaFRva2VuCiAgICAgIH0KICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgcm91dGVyLnJlcGxhY2UoIi9sb2dpbiIpOwogICAgfSk7CiAgICAvLyDkv53lrZh0b2tlbgogICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgiYWNjZXNzVG9rZW4iLCBkYXRhLmFjY2Vzc1Rva2VuKTsKICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oInJlZnJlc2hUb2tlbiIsIGRhdGEucmVmcmVzaFRva2VuKTsKICAgIC8vIOi/memHjOmcgOimgeaKimhlYWRlcnPmuIXmjonvvIzlkKbliJnor7fmsYLml7bkvJrmiqXplJnvvIzljp/lm6DmmoLkuI3or6YuLi4KICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuY29uZmlnLmRhdGEgIT0gJ29iamVjdCcpIHsKICAgICAgcmVzcG9uc2UuY29uZmlnLmhlYWRlcnMgPSB1bmRlZmluZWQ7CiAgICB9CiAgICAvLyDph43mlrDlj5HpgIHliJrmiY3nmoTor7fmsYIKICAgIHJldHVybiBodHRwKHJlc3BvbnNlLmNvbmZpZyk7CiAgfSBlbHNlIHsKICAgIE1lc3NhZ2UoewogICAgICBtZXNzYWdlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UsCiAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICBjdXN0b21DbGFzczogJ2VsZW1lbnQtZXJyb3ItbWVzc2FnZS16aW5kZXgnCiAgICB9KTsKICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5kYXRhKTsKICB9Cn0sIGVycm9yID0+IHsKICBzd2l0Y2ggKGVycm9yLnJlc3BvbnNlLnN0YXR1cykgewogICAgY2FzZSA0MDA6CiAgICAgIE1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6IGVycm9yLnJlc3BvbnNlLmRhdGEsCiAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgICBjdXN0b21DbGFzczogJ2VsZW1lbnQtZXJyb3ItbWVzc2FnZS16aW5kZXgnCiAgICAgIH0pOwogICAgICBicmVhazsKICAgIGNhc2UgNDAxOgogICAgICByb3V0ZXIucmVwbGFjZSgiL2xvZ2luIik7CiAgICAgIGJyZWFrOwogICAgY2FzZSA0MDU6CiAgICAgIE1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6ICdodHRw6K+35rGC5pa55byP5pyJ6K+vJywKICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICAgIGN1c3RvbUNsYXNzOiAnZWxlbWVudC1lcnJvci1tZXNzYWdlLXppbmRleCcKICAgICAgfSk7CiAgICAgIGJyZWFrOwogICAgY2FzZSA0MDQ6CiAgICBjYXNlIDUwMDoKICAgICAgTWVzc2FnZSh7CiAgICAgICAgbWVzc2FnZTogJ+acjeWKoeWZqOWHuuS6hueCueWwj+W3ru+8jOivt+eojeWQjuWGjeivlScsCiAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgICBjdXN0b21DbGFzczogJ2VsZW1lbnQtZXJyb3ItbWVzc2FnZS16aW5kZXgnCiAgICAgIH0pOwogICAgICBicmVhazsKICAgIGNhc2UgNTAxOgogICAgICBNZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn5pyN5Yqh5Zmo5LiN5pSv5oyB5b2T5YmN6K+35rGC5omA6ZyA6KaB55qE5p+Q5Liq5Yqf6IO9JywKICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICAgIGN1c3RvbUNsYXNzOiAnZWxlbWVudC1lcnJvci1tZXNzYWdlLXppbmRleCcKICAgICAgfSk7CiAgICAgIGJyZWFrOwogIH0KICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKZXhwb3J0IGRlZmF1bHQgaHR0cDs="},{"version":3,"names":["axios","router","Message","http","create","baseURL","process","env","VUE_APP_BASE_API","timeout","withCredentials","headers","interceptors","request","use","config","accessToken","sessionStorage","getItem","encodeURIComponent","error","Promise","reject","response","data","code","replace","console","log","refreshToken","method","url","catch","setItem","undefined","message","type","duration","customClass","status"],"sources":["D:/im-ui/src/api/httpRequest.js"],"sourcesContent":["import axios from 'axios'\nimport router from '@/router'\nimport {\n\tMessage\n} from 'element-ui'\n\nconst http = axios.create({\n\tbaseURL: process.env.VUE_APP_BASE_API,\n\ttimeout: 1000 * 30,\n\twithCredentials: true,\n\theaders: {\n\t\t'Content-Type': 'application/json; charset=utf-8'\n\t}\n})\n\n/**\n * 请求拦截\n */\nhttp.interceptors.request.use(config => {\n\tlet accessToken = sessionStorage.getItem(\"accessToken\");\n\tif (accessToken) {\n\t\tconfig.headers.accessToken = encodeURIComponent(accessToken);\n\t}\n\treturn config\n}, error => {\n\treturn Promise.reject(error)\n})\n\n/**\n * 响应拦截\n */\nhttp.interceptors.response.use(async response => {\n\tif (response.data.code == 200) {\n\t\treturn response.data.data;\n\t} else if (response.data.code == 400) {\n\t\trouter.replace(\"/login\");\n\t} else if (response.data.code == 401) {\n\t\tconsole.log(\"token失效，尝试重新获取\")\n\t\tlet refreshToken = sessionStorage.getItem(\"refreshToken\");\n\t\tif (!refreshToken) {\n\t\t\trouter.replace(\"/login\");\n\t\t}\n\t\t// 发送请求, 进行刷新token操作, 获取新的token\n\t\tconst data = await http({\n\t\t\tmethod: 'put',\n\t\t\turl: '/refreshToken',\n\t\t\theaders: {\n\t\t\t\trefreshToken: refreshToken\n\t\t\t}\n\t\t}).catch(()=>{\n\t\t\trouter.replace(\"/login\");\n\t\t})\n\t\t// 保存token\n\t\tsessionStorage.setItem(\"accessToken\", data.accessToken);\n\t\tsessionStorage.setItem(\"refreshToken\", data.refreshToken);\n\t\t// 这里需要把headers清掉，否则请求时会报错，原因暂不详...\n\t\tif(typeof response.config.data != 'object'){\n\t\t\tresponse.config.headers=undefined;\n\t\t}\n\t\t// 重新发送刚才的请求\n\t\treturn http(response.config)\n\t} else {\n\t\tMessage({\n\t\t\tmessage: response.data.message,\n\t\t\ttype: 'error',\n\t\t\tduration: 1500,\n\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t})\n\t\treturn Promise.reject(response.data)\n\t}\n}, error => {\n\tswitch (error.response.status) {\n\t\tcase 400:\n\t\t\tMessage({\n\t\t\t\tmessage: error.response.data,\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 401:\n\t\t\trouter.replace(\"/login\");\n\t\t\tbreak\n\t\tcase 405:\n\t\t\tMessage({\n\t\t\t\tmessage: 'http请求方式有误',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 404:\n\t\tcase 500:\n\t\t\tMessage({\n\t\t\t\tmessage: '服务器出了点小差，请稍后再试',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 501:\n\t\t\tMessage({\n\t\t\t\tmessage: '服务器不支持当前请求所需要的某个功能',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t}\n\n\treturn Promise.reject(error)\n})\n\n\nexport default http\n"],"mappings":"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","ignoreList":[]}]}