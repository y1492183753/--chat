{"remainingRequest":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\im-ui\\src\\components\\chat\\ChatVoice.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\im-ui\\src\\components\\chat\\ChatVoice.vue","mtime":1703809564000},{"path":"D:\\im-ui\\babel.config.js","mtime":1703809560000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1710142166000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1710142168000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmRlbGV0ZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5oYXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuc2l6ZS5qcyI7CmltcG9ydCBSZWNvcmRlciBmcm9tICdqcy1hdWRpby1yZWNvcmRlcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnY2hhdFZvaWNlJywKICBwcm9wczogewogICAgdmlzaWJsZTogewogICAgICB0eXBlOiBCb29sZWFuCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcmM6IG5ldyBSZWNvcmRlcigpLAogICAgICBhdWRpbzogbmV3IEF1ZGlvKCksCiAgICAgIHN0YXRlOiAnU1RPUCcsCiAgICAgIC8vIFNUT1DjgIFSVU5OSU5H44CBUEFVU0XjgIFDT01QTEVURQogICAgICBzdGF0ZVRpcDogIuacquW8gOWniyIsCiAgICAgIG1vZGU6ICdSRUNPUkQnLAogICAgICAvLyBSRUNPUkQg44CBUExBWQogICAgICBkdXJhdGlvbjogMCwKICAgICAgdXJsOiAiIgogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9uQ2xvc2UoKSB7CiAgICAgIC8vIOWFs+mXreWJjea4hemZpOaVsOaNrgogICAgICB0aGlzLnJjLmRlc3Ryb3koKTsKICAgICAgdGhpcy5yYyA9IG5ldyBSZWNvcmRlcigpOwogICAgICB0aGlzLmF1ZGlvLnBhdXNlKCk7CiAgICAgIHRoaXMubW9kZSA9ICdSRUNPUkQnOwogICAgICB0aGlzLnN0YXRlID0gJ1NUT1AnOwogICAgICB0aGlzLnN0YXRlVGlwID0gJ+acquW8gOWniyc7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlIik7CiAgICB9LAogICAgb25TdGFydFJlY29yZCgpIHsKICAgICAgdGhpcy5yYy5zdGFydCgpLnRoZW4oc3RyZWFtID0+IHsKICAgICAgICB0aGlzLnN0YXRlID0gJ1JVTk5JTkcnOwogICAgICAgIHRoaXMuc3RhdGVUaXAgPSAi5q2j5Zyo5b2V6Z+zLi4uIjsKICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGVycm9yKTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIG9uUGF1c2VSZWNvcmQoKSB7CiAgICAgIHRoaXMucmMucGF1c2UoKTsKICAgICAgdGhpcy5zdGF0ZSA9ICdQQVVTRSc7CiAgICAgIHRoaXMuc3RhdGVUaXAgPSAi5bey5pqC5YGc5b2V6Z+zIjsKICAgIH0sCiAgICBvblJlc3VtZVJlY29yZCgpIHsKICAgICAgdGhpcy5yYy5yZXN1bWUoKTsKICAgICAgdGhpcy5zdGF0ZSA9ICdSVU5OSU5HJzsKICAgICAgdGhpcy5zdGF0ZVRpcCA9ICLmraPlnKjlvZXpn7MuLi4iOwogICAgfSwKICAgIG9uQ29tcGxldGVSZWNvcmQoKSB7CiAgICAgIHRoaXMucmMucGF1c2UoKTsKICAgICAgdGhpcy5zdGF0ZSA9ICdDT01QTEVURSc7CiAgICAgIHRoaXMuc3RhdGVUaXAgPSAi5bey57uT5p2f5b2V6Z+zIjsKICAgIH0sCiAgICBvblBsYXlBdWRpbygpIHsKICAgICAgbGV0IHdhdiA9IHRoaXMucmMuZ2V0V0FWQmxvYigpOwogICAgICBsZXQgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh3YXYpOwogICAgICB0aGlzLiRyZWZzLmF1ZGlvLnNyYyA9IHVybDsKICAgICAgdGhpcy4kcmVmcy5hdWRpby5wbGF5KCk7CiAgICAgIHRoaXMubW9kZSA9ICdQTEFZJzsKICAgIH0sCiAgICBvblN0b3BBdWRpbygpIHsKICAgICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5hdWRpbyk7CiAgICAgIHRoaXMuJHJlZnMuYXVkaW8ucGF1c2UoKTsKICAgICAgdGhpcy5tb2RlID0gJ1JFQ09SRCc7CiAgICB9LAogICAgb25SZXN0YXJ0UmVjb3JkKCkgewogICAgICB0aGlzLnJjLmRlc3Ryb3koKTsKICAgICAgdGhpcy5yYyA9IG5ldyBSZWNvcmRlcigpOwogICAgICB0aGlzLnJjLnN0YXJ0KCk7CiAgICAgIHRoaXMuc3RhdGUgPSAnUlVOTklORyc7CiAgICAgIHRoaXMubW9kZSA9ICdSRUNPUkQnOwogICAgICB0aGlzLnN0YXRlVGlwID0gIuato+WcqOW9lemfsy4uLiI7CiAgICB9LAogICAgb25TZW5kUmVjb3JkKCkgewogICAgICBsZXQgd2F2ID0gdGhpcy5yYy5nZXRXQVZCbG9iKCk7CiAgICAgIGxldCBuYW1lID0gbmV3IERhdGUoKS5nZXREYXRlKCkgKyAnLndhdic7CiAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyB3aW5kb3cuRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgd2F2LCBuYW1lKTsKICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgdXJsOiAnL2ZpbGUvdXBsb2FkJywKICAgICAgICBkYXRhOiBmb3JtRGF0YSwKICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgICAgfQogICAgICB9KS50aGVuKHVybCA9PiB7CiAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICBkdXJhdGlvbjogcGFyc2VJbnQodGhpcy5yYy5kdXJhdGlvbiksCiAgICAgICAgICB1cmw6IHVybAogICAgICAgIH07CiAgICAgICAgdGhpcy4kZW1pdCgic2VuZCIsIGRhdGEpOwogICAgICAgIHRoaXMub25DbG9zZSgpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["Recorder","name","props","visible","type","Boolean","data","rc","audio","Audio","state","stateTip","mode","duration","url","methods","onClose","destroy","pause","$emit","onStartRecord","start","then","stream","catch","error","console","log","$message","onPauseRecord","onResumeRecord","resume","onCompleteRecord","onPlayAudio","wav","getWAVBlob","URL","createObjectURL","$refs","src","play","onStopAudio","onRestartRecord","onSendRecord","Date","getDate","formData","window","FormData","append","$http","method","headers","parseInt"],"sources":["src/components/chat/ChatVoice.vue"],"sourcesContent":["<template>\n\t<el-dialog class=\"chat-voice\" title=\"语音录制\" :visible.sync=\"visible\" width=\"600px\" :before-close=\"onClose\">\n\t\t<div v-show=\"mode=='RECORD'\">\n\t\t\t<div class=\"chat-voice-tip\">{{stateTip}}</div>\n\t\t\t<div>时长: {{state=='STOP'?0:parseInt(rc.duration)}}s</div>\n\t\t</div>\n\t\t<audio v-show=\"mode=='PLAY'\" :src=\"url\" controls ref=\"audio\" @ended=\"onStopAudio()\"></audio>\n\t\t<el-divider content-position=\"center\"></el-divider>\n\t\t<el-row class=\"chat-voice-btn-group\">\n\t\t\t<el-button round type=\"primary\" v-show=\"state=='STOP'\" @click=\"onStartRecord()\">开始录音</el-button>\n\t\t\t<el-button round type=\"warning\" v-show=\"state=='RUNNING'\" @click=\"onPauseRecord()\">暂停录音</el-button>\n\t\t\t<el-button round type=\"primary\" v-show=\"state=='PAUSE'\" @click=\"onResumeRecord()\">继续录音</el-button>\n\t\t\t<el-button round type=\"danger\" v-show=\"state=='RUNNING'||state=='PAUSE'\" @click=\"onCompleteRecord()\">\n\t\t\t\t结束录音</el-button>\n\t\t\t<el-button round type=\"success\" v-show=\"state=='COMPLETE' && mode!='PLAY'\" @click=\"onPlayAudio()\">播放录音\n\t\t\t</el-button>\n\t\t\t<el-button round type=\"warning\" v-show=\"state=='COMPLETE' && mode=='PLAY'\" @click=\"onStopAudio()\">停止播放\n\t\t\t</el-button>\n\t\t\t<el-button round type=\"primary\" v-show=\"state=='COMPLETE'\" @click=\"onRestartRecord()\">重新录音</el-button>\n\t\t\t<el-button round type=\"primary\" v-show=\"state=='COMPLETE'\" @click=\"onSendRecord()\">立即发送</el-button>\n\t\t</el-row>\n\t</el-dialog>\n\n</template>\n\n<script>\n\timport Recorder from 'js-audio-recorder';\n\n\texport default {\n\t\tname: 'chatVoice',\n\t\tprops: {\n\t\t\tvisible: {\n\t\t\t\ttype: Boolean\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\trc: new Recorder(),\n\t\t\t\taudio: new Audio(),\n\t\t\t\tstate: 'STOP', // STOP、RUNNING、PAUSE、COMPLETE\n\t\t\t\tstateTip: \"未开始\",\n\t\t\t\tmode: 'RECORD', // RECORD 、PLAY\n\t\t\t\tduration: 0,\n\t\t\t\turl: \"\"\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tonClose() {\n\t\t\t\t// 关闭前清除数据\n\t\t\t\tthis.rc.destroy();\n\t\t\t\tthis.rc = new Recorder();\n\t\t\t\tthis.audio.pause();\n\t\t\t\tthis.mode = 'RECORD';\n\t\t\t\tthis.state = 'STOP';\n\t\t\t\tthis.stateTip = '未开始';\n\t\t\t\tthis.$emit(\"close\");\n\t\t\t},\n\t\t\tonStartRecord() {\n\t\t\t\tthis.rc.start().then((stream) => {\n\t\t\t\t\tthis.state = 'RUNNING';\n\t\t\t\t\tthis.stateTip = \"正在录音...\";\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tthis.$message.error(error);\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t});\n\n\n\t\t\t},\n\t\t\tonPauseRecord() {\n\t\t\t\tthis.rc.pause();\n\t\t\t\tthis.state = 'PAUSE';\n\t\t\t\tthis.stateTip = \"已暂停录音\";\n\t\t\t},\n\t\t\tonResumeRecord() {\n\t\t\t\tthis.rc.resume();\n\t\t\t\tthis.state = 'RUNNING';\n\t\t\t\tthis.stateTip = \"正在录音...\";\n\t\t\t},\n\t\t\tonCompleteRecord() {\n\t\t\t\tthis.rc.pause();\n\t\t\t\tthis.state = 'COMPLETE';\n\t\t\t\tthis.stateTip = \"已结束录音\";\n\t\t\t},\n\t\t\tonPlayAudio() {\n\t\t\t\tlet wav = this.rc.getWAVBlob();\n\t\t\t\tlet url = URL.createObjectURL(wav);\n\t\t\t\tthis.$refs.audio.src = url;\n\t\t\t\tthis.$refs.audio.play();\n\t\t\t\tthis.mode = 'PLAY';\n\t\t\t},\n\t\t\tonStopAudio() {\n\t\t\t\tconsole.log(this.$refs.audio);\n\t\t\t\tthis.$refs.audio.pause();\n\t\t\t\tthis.mode = 'RECORD';\n\t\t\t},\n\t\t\tonRestartRecord() {\n\t\t\t\tthis.rc.destroy();\n\t\t\t\tthis.rc = new Recorder()\n\t\t\t\tthis.rc.start();\n\t\t\t\tthis.state = 'RUNNING';\n\t\t\t\tthis.mode = 'RECORD';\n\t\t\t\tthis.stateTip = \"正在录音...\";\n\t\t\t},\n\t\t\tonSendRecord() {\n\t\t\t\tlet wav = this.rc.getWAVBlob();\n\t\t\t\tlet name = new Date().getDate() + '.wav';\n\t\t\t\tvar formData = new window.FormData()\n\t\t\t\tformData.append('file', wav, name);\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: '/file/upload',\n\t\t\t\t\tdata: formData,\n\t\t\t\t\tmethod: 'post',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'multipart/form-data'\n\t\t\t\t\t}\n\t\t\t\t}).then((url) => {\n\t\t\t\t\tlet data = {\n\t\t\t\t\t\tduration: parseInt(this.rc.duration),\n\t\t\t\t\t\turl: url\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit(\"send\", data);\n\t\t\t\t\tthis.onClose();\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.chat-voice {\n\n\t\t.chat-voice-tip {\n\t\t\tfont-size: 18px;\n\t\t}\n\n\t\t.chat-voice-btn-group {\n\t\t\tmargin-bottom: 20px;\n\t\t}\n\t}\n</style>\n"],"mappings":";;;AA0BA,OAAAA,QAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACAC,OAAA;MACAC,IAAA,EAAAC;IACA;EACA;EACAC,KAAA;IACA;MACAC,EAAA,MAAAP,QAAA;MACAQ,KAAA,MAAAC,KAAA;MACAC,KAAA;MAAA;MACAC,QAAA;MACAC,IAAA;MAAA;MACAC,QAAA;MACAC,GAAA;IACA;EACA;EACAC,OAAA;IACAC,QAAA;MACA;MACA,KAAAT,EAAA,CAAAU,OAAA;MACA,KAAAV,EAAA,OAAAP,QAAA;MACA,KAAAQ,KAAA,CAAAU,KAAA;MACA,KAAAN,IAAA;MACA,KAAAF,KAAA;MACA,KAAAC,QAAA;MACA,KAAAQ,KAAA;IACA;IACAC,cAAA;MACA,KAAAb,EAAA,CAAAc,KAAA,GAAAC,IAAA,CAAAC,MAAA;QACA,KAAAb,KAAA;QACA,KAAAC,QAAA;MACA,GAAAa,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,KAAA;QACA,KAAAG,QAAA,CAAAH,KAAA,CAAAA,KAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,KAAA;MACA;IAGA;IACAI,cAAA;MACA,KAAAtB,EAAA,CAAAW,KAAA;MACA,KAAAR,KAAA;MACA,KAAAC,QAAA;IACA;IACAmB,eAAA;MACA,KAAAvB,EAAA,CAAAwB,MAAA;MACA,KAAArB,KAAA;MACA,KAAAC,QAAA;IACA;IACAqB,iBAAA;MACA,KAAAzB,EAAA,CAAAW,KAAA;MACA,KAAAR,KAAA;MACA,KAAAC,QAAA;IACA;IACAsB,YAAA;MACA,IAAAC,GAAA,QAAA3B,EAAA,CAAA4B,UAAA;MACA,IAAArB,GAAA,GAAAsB,GAAA,CAAAC,eAAA,CAAAH,GAAA;MACA,KAAAI,KAAA,CAAA9B,KAAA,CAAA+B,GAAA,GAAAzB,GAAA;MACA,KAAAwB,KAAA,CAAA9B,KAAA,CAAAgC,IAAA;MACA,KAAA5B,IAAA;IACA;IACA6B,YAAA;MACAf,OAAA,CAAAC,GAAA,MAAAW,KAAA,CAAA9B,KAAA;MACA,KAAA8B,KAAA,CAAA9B,KAAA,CAAAU,KAAA;MACA,KAAAN,IAAA;IACA;IACA8B,gBAAA;MACA,KAAAnC,EAAA,CAAAU,OAAA;MACA,KAAAV,EAAA,OAAAP,QAAA;MACA,KAAAO,EAAA,CAAAc,KAAA;MACA,KAAAX,KAAA;MACA,KAAAE,IAAA;MACA,KAAAD,QAAA;IACA;IACAgC,aAAA;MACA,IAAAT,GAAA,QAAA3B,EAAA,CAAA4B,UAAA;MACA,IAAAlC,IAAA,OAAA2C,IAAA,GAAAC,OAAA;MACA,IAAAC,QAAA,OAAAC,MAAA,CAAAC,QAAA;MACAF,QAAA,CAAAG,MAAA,SAAAf,GAAA,EAAAjC,IAAA;MACA,KAAAiD,KAAA;QACApC,GAAA;QACAR,IAAA,EAAAwC,QAAA;QACAK,MAAA;QACAC,OAAA;UACA;QACA;MACA,GAAA9B,IAAA,CAAAR,GAAA;QACA,IAAAR,IAAA;UACAO,QAAA,EAAAwC,QAAA,MAAA9C,EAAA,CAAAM,QAAA;UACAC,GAAA,EAAAA;QACA;QACA,KAAAK,KAAA,SAAAb,IAAA;QACA,KAAAU,OAAA;MACA;IACA;EACA;AAEA","ignoreList":[]}]}