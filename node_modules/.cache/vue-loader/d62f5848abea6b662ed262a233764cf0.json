{"remainingRequest":"D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\im-ui\\src\\components\\chat\\ChatVideoAcceptor.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\im-ui\\src\\components\\chat\\ChatVideoAcceptor.vue","mtime":1703809564000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1710142166000},{"path":"D:\\im-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710142170000},{"path":"D:\\im-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1710142168000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CglpbXBvcnQgSGVhZEltYWdlIGZyb20gJy4uL2NvbW1vbi9IZWFkSW1hZ2UudnVlJzsKCglleHBvcnQgZGVmYXVsdCB7CgkJbmFtZTogInZpZGVvQWNjZXB0b3IiLAoJCWNvbXBvbmVudHM6IHsKCQkJSGVhZEltYWdlCgkJfSwKCQlwcm9wczogewoJCQlmcmllbmQ6IHsKCQkJCXR5cGU6IE9iamVjdAoJCQl9CgkJfSwKCQlkYXRhKCkgewoJCQlyZXR1cm4gewoJCQkJb2ZmZXI6IHt9LAoJCQkJYXVkaW86IG5ldyBBdWRpbygpCgkJCX0KCQl9LAoJCW1ldGhvZHM6IHsKCQkJYWNjcGV0KCkgewoJCQkJbGV0IGluZm8gPSB7CgkJCQkJZnJpZW5kOiB0aGlzLmZyaWVuZCwKCQkJCQltYXN0ZXI6IGZhbHNlLAoJCQkJCW9mZmVyOiB0aGlzLm9mZmVyCgkJCQl9CgkJCQl0aGlzLiRzdG9yZS5jb21taXQoInNob3dDaGF0UHJpdmF0ZVZpZGVvQm94IiwgaW5mbyk7CgkJCQl0aGlzLmNsb3NlKCk7CgkJCX0sCgkJCXJlamVjdCgpIHsKCQkJCXRoaXMuJGh0dHAoewoJCQkJCXVybDogYC93ZWJydGMvcHJpdmF0ZS9yZWplY3Q/dWlkPSR7dGhpcy5mcmllbmQuaWR9YCwKCQkJCQltZXRob2Q6ICdwb3N0JwoJCQkJfSkKCQkJCXRoaXMuY2xvc2UoKTsKCQkJfSwKCQkJZmFpbGVkKHJlYXNvbikgewoJCQkJdGhpcy4kaHR0cCh7CgkJCQkJdXJsOiBgL3dlYnJ0Yy9wcml2YXRlL2ZhaWxlZD91aWQ9JHt0aGlzLmZyaWVuZC5pZH0mcmVhc29uPSR7cmVhc29ufWAsCgkJCQkJbWV0aG9kOiAncG9zdCcKCQkJCX0pCgkJCQl0aGlzLmNsb3NlKCk7CgkJCX0sCgkJCW9uQ2FsbChtc2dJbmZvKSB7CgkJCQl0aGlzLm9mZmVyID0gSlNPTi5wYXJzZShtc2dJbmZvLmNvbnRlbnQpOwoJCQkJaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJTdG9yZS5zdGF0ZSA9PSB0aGlzLiRlbnVtcy5VU0VSX1NUQVRFLkJVU1kpIHsKCQkJCQl0aGlzLmZhaWxlZCgi5a+55pa55q2j5b+ZLOaaguaXtuaXoOazleaOpeWQrCIpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJCS8vIOi2heaXtuacquaOpeWQrAoJCQkJdGhpcy50aW1lciAmJiBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7CgkJCQl0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CgkJCQkJdGhpcy5mYWlsZWQoIuWvueaWueacquaOpeWQrCIpOwoJCQkJfSwgMzAwMDApCgkJCQl0aGlzLmF1ZGlvLnBsYXkoKTsKCQkJfSwKCQkJb25DYW5jZWwoKSB7CgkJCQkvLyDlj5bmtojop4bpopHpgJror53or7fmsYIKCQkJCXRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5a+55pa55Y+W5raI5LqG5ZG85Y+rIik7CgkJCQl0aGlzLmNsb3NlKCk7CgkJCX0sCgkJCWhhbmRsZU1lc3NhZ2UobXNnSW5mbykgewoJCQkJaWYgKG1zZ0luZm8udHlwZSA9PSB0aGlzLiRlbnVtcy5NRVNTQUdFX1RZUEUuUlRDX0NBTEwpIHsKCQkJCQl0aGlzLm9uQ2FsbChtc2dJbmZvKTsKCQkJCX0gZWxzZSBpZiAobXNnSW5mby50eXBlID09IHRoaXMuJGVudW1zLk1FU1NBR0VfVFlQRS5SVENfQ0FOQ0VMKSB7CgkJCQkJdGhpcy5vbkNhbmNlbCgpOwoJCQkJfQoJCQl9LAoJCQljbG9zZSgpIHsKCQkJCXRoaXMudGltZXIgJiYgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwoJCQkJdGhpcy5hdWRpby5wYXVzZSgpOwoJCQkJdGhpcy4kZW1pdCgiY2xvc2UiKTsKCQkJfSwKCQkJaW5pdEF1ZGlvKCkgewoJCQkJbGV0IHVybCA9IHJlcXVpcmUoYEAvYXNzZXRzL2F1ZGlvL2NhbGwud2F2YCk7CgkJCQl0aGlzLmF1ZGlvLnNyYyA9IHVybDsKCQkJCXRoaXMuYXVkaW8ubG9vcCA9IHRydWU7CgkJCX0KCQl9LAoJCW1vdW50ZWQoKSB7CgkJCS8vIOWIneWni+WMluivremfswoJCQl0aGlzLmluaXRBdWRpbygpOwoKCQl9Cgl9Cg=="},{"version":3,"sources":["ChatVideoAcceptor.vue"],"names":[],"mappings":";AAgBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"ChatVideoAcceptor.vue","sourceRoot":"src/components/chat","sourcesContent":["<template>\n\t<div class=\"chat-video-acceptor\">\n\n\t\t<head-image :id=\"friend.id\" :name=\"friend.nickName\" :url=\"friend.headImage\" :size=\"100\"></head-image>\n\n\t\t<div class=\"acceptor-text\">\n\t\t\t{{friend.nickName}} 请求和您进行视频通话...\n\t\t</div>\n\t\t<div class=\"acceptor-btn-group\">\n\t\t\t<div class=\"icon iconfont icon-phone-accept accept\" @click=\"accpet()\" title=\"接受\"></div>\n\t\t\t<div class=\"icon iconfont icon-phone-reject reject\" @click=\"reject()\" title=\"拒绝\"></div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport HeadImage from '../common/HeadImage.vue';\n\n\texport default {\n\t\tname: \"videoAcceptor\",\n\t\tcomponents: {\n\t\t\tHeadImage\n\t\t},\n\t\tprops: {\n\t\t\tfriend: {\n\t\t\t\ttype: Object\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\toffer: {},\n\t\t\t\taudio: new Audio()\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\taccpet() {\n\t\t\t\tlet info = {\n\t\t\t\t\tfriend: this.friend,\n\t\t\t\t\tmaster: false,\n\t\t\t\t\toffer: this.offer\n\t\t\t\t}\n\t\t\t\tthis.$store.commit(\"showChatPrivateVideoBox\", info);\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\treject() {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/webrtc/private/reject?uid=${this.friend.id}`,\n\t\t\t\t\tmethod: 'post'\n\t\t\t\t})\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\tfailed(reason) {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/webrtc/private/failed?uid=${this.friend.id}&reason=${reason}`,\n\t\t\t\t\tmethod: 'post'\n\t\t\t\t})\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\tonCall(msgInfo) {\n\t\t\t\tthis.offer = JSON.parse(msgInfo.content);\n\t\t\t\tif (this.$store.state.userStore.state == this.$enums.USER_STATE.BUSY) {\n\t\t\t\t\tthis.failed(\"对方正忙,暂时无法接听\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// 超时未接听\n\t\t\t\tthis.timer && clearTimeout(this.timer);\n\t\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\t\tthis.failed(\"对方未接听\");\n\t\t\t\t}, 30000)\n\t\t\t\tthis.audio.play();\n\t\t\t},\n\t\t\tonCancel() {\n\t\t\t\t// 取消视频通话请求\n\t\t\t\tthis.$message.success(\"对方取消了呼叫\");\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\thandleMessage(msgInfo) {\n\t\t\t\tif (msgInfo.type == this.$enums.MESSAGE_TYPE.RTC_CALL) {\n\t\t\t\t\tthis.onCall(msgInfo);\n\t\t\t\t} else if (msgInfo.type == this.$enums.MESSAGE_TYPE.RTC_CANCEL) {\n\t\t\t\t\tthis.onCancel();\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose() {\n\t\t\t\tthis.timer && clearTimeout(this.timer);\n\t\t\t\tthis.audio.pause();\n\t\t\t\tthis.$emit(\"close\");\n\t\t\t},\n\t\t\tinitAudio() {\n\t\t\t\tlet url = require(`@/assets/audio/call.wav`);\n\t\t\t\tthis.audio.src = url;\n\t\t\t\tthis.audio.loop = true;\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\t// 初始化语音\n\t\t\tthis.initAudio();\n\n\t\t}\n\t}\n</script>\n\n<style scoped lang=\"scss\">\n\t.chat-video-acceptor {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tright: 5px;\n\t\tbottom: 5px;\n\t\twidth: 250px;\n\t\theight: 250px;\n\t\tpadding: 20px;\n\t\tbackground-color: #eeeeee;\n\t\tborder: #dddddd solid 5px;\n\t\tborder-radius: 3%;\n\n\t\t.acceptor-text {\n\t\t\tpadding: 10px;\n\t\t\ttext-align: center;\n\t\t\tfont-size: 16px;\n\t\t}\n\n\t\t.acceptor-btn-group {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-around;\n\t\t\tmargin-top: 20px;\n\t\t\twidth: 100%;\n\n\t\t\t.icon {\n\t\t\t\tfont-size: 60px;\n\t\t\t\tcursor: pointer;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\t&.accept {\n\t\t\t\t\tcolor: green;\n\t\t\t\t\tanimation: anim 2s ease-in infinite, vibration 2s ease-in infinite;\n\n\t\t\t\t\t@keyframes anim {\n\t\t\t\t\t\t0% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 4px #ffffff;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t10% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 8px rgba(255, 165, 0, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t25% {\n\t\t\t\t\t\t\tbox-shadow: 0 1px 0 12px rgba(255, 210, 128, 1), 0 1px 0 16px rgba(255, 201, 102, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t50% {\n\t\t\t\t\t\t\tbox-shadow: 0 2px 5px 10px rgba(255, 184, 51, 1), 0 2px 5px 23px rgba(248, 248, 255, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t@keyframes vibration {\n\t\t\t\t\t\t0% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t25% {\n\t\t\t\t\t\t\ttransform: rotate(20deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t50% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t75% {\n\t\t\t\t\t\t\ttransform: rotate(-15deg);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t&.reject {\n\t\t\t\t\tcolor: red;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>"]}]}